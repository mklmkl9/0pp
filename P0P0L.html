<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø±Ø­Ù„Ø© ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© âœ¨</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
body {
  font-family: Tahoma, Arial, sans-serif;
  background: linear-gradient(to right,#a1c4fd,#c2e9fb);
  text-align: center;
  padding: 20px;
  overflow-x: hidden;
}
.hidden { display: none; }
button {
  padding: 12px 25px;
  font-size: 20px;
  background: #ff9671;
  color: white;
  border: none;
  border-radius: 30px;
  margin: 10px;
  cursor: pointer;
  transition: background 0.3s;
}
button:hover { background: #ff6f91; }
.lesson {
  background: white;
  padding: 20px;
  margin: 20px auto;
  border-radius: 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  max-width: 600px;
}
.lesson img {
  width: 200px;
  height: 200px;
  object-fit: cover;
  border-radius: 20px;
  margin-bottom: 15px;
}
#progress-container {
  width: 90%;
  background: #ddd;
  height: 20px;
  margin: 20px auto;
  border-radius: 10px;
  overflow: hidden;
}
#progress-bar {
  height: 100%;
  width: 0%;
  background: #845ec2;
  transition: width 0.5s ease;
}
#progress-text {
  font-size: 18px;
  margin-bottom: 10px;
  color: #333;
}
#certificatePage {
  background: #fff;
  padding: 30px;
  border-radius: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  max-width: 700px;
  margin: 50px auto;
  text-align: center;
}
#certificatePage h1 {
  color: #4CAF50;
  font-size: 40px;
  margin-bottom: 10px;
}
#certificatePage h2 {
  font-size: 28px;
  color: #333;
}
#certificatePage p {
  font-size: 20px;
  color: #555;
}
</style>
</head>
<body>
<!-- ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
<div id="startPage">
  <h1>âœ¨ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø±Ø­Ù„Ø© ØªØ¹Ù„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© âœ¨</h1>
  <button onclick="startLessons()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† ğŸš€</button>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ -->
<div id="lessonPage" class="hidden">
  <div id="progress-text">0%</div>
  <div id="progress-container"><div id="progress-bar"></div></div>
  <div id="lessonArea"></div>
  <button id="nextButton" onclick="next()">Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
  <div id="timer" style="font-size: 20px; color: red; margin-top: 10px;"></div>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© -->
<div id="certificatePage" class="hidden">
  <h1>Ù…Ø¨Ø±ÙˆÙƒ!</h1>
  <p>Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø±Ø­Ù„ØªÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!</p>
  <h2>Ù†Ø¬Ù…Ù†Ø§ Ø§Ù„Ù…Ø¨Ø¯Ø¹!</h2>
  <button onclick="downloadCertificate()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ğŸ“„</button>
  <button onclick="restart()">Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯ ğŸ”„</button>
</div>

<!-- ØµÙˆØª Ø§Ù„ØªØµÙÙŠÙ‚ -->
<audio id="clapSound" src="https://www.fesliyanstudios.com/play-mp3/387" preload="auto"></audio>

<script>
// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª + Ø§Ù„ØµÙˆØ± Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ©
const lessons = [
  {word: "Apple", meaning: "ØªÙØ§Ø­Ø©", image: "https://upload.wikimedia.org/wikipedia/commons/1/15/Red_Apple.jpg"},
  {word: "Ball", meaning: "ÙƒØ±Ø©", image: "https://upload.wikimedia.org/wikipedia/commons/6/6d/Soccer_ball.svg"},
  {word: "Cat", meaning: "Ù‚Ø·Ø©", image: "https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg"},
  {word: "Dog", meaning: "ÙƒÙ„Ø¨", image: "https://upload.wikimedia.org/wikipedia/commons/7/7e/Dog_face.png"},
  {word: "Book", meaning: "ÙƒØªØ§Ø¨", image: "https://upload.wikimedia.org/wikipedia/commons/8/89/Book.png"},
  {word: "Pen", meaning: "Ù‚Ù„Ù…", image: "https://upload.wikimedia.org/wikipedia/commons/0/0b/Blue_pen.png"},
  {word: "Chair", meaning: "ÙƒØ±Ø³ÙŠ", image: "https://upload.wikimedia.org/wikipedia/commons/3/37/Chair.png"},
  {word: "Table", meaning: "Ø·Ø§ÙˆÙ„Ø©", image: "https://upload.wikimedia.org/wikipedia/commons/7/7d/Table.png"},
  {word: "Bag", meaning: "Ø­Ù‚ÙŠØ¨Ø©", image: "https://upload.wikimedia.org/wikipedia/commons/9/9d/Backpack.jpg"},
  {word: "Shoe", meaning: "Ø­Ø°Ø§Ø¡", image: "https://upload.wikimedia.org/wikipedia/commons/f/f9/Shoes.png"},
  // <<< Ø³Ø£ÙƒÙ…Ù„ Ø¨Ù‚ÙŠØ© Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙÙˆÙ‚ 100 ÙƒÙ„Ù…Ø© ÙÙŠ Ø§Ù„Ø¨ÙˆÙƒØ³Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© >>>
];
// Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
let currentIndex = parseInt(localStorage.getItem('currentLesson')) || 0;
let isQuiz = false;
let timerInterval;

// Ø¨Ø¯Ø¡ Ø§Ù„Ø¯Ø±ÙˆØ³
function startLessons() {
  document.getElementById('startPage').classList.add('hidden');
  document.getElementById('lessonPage').classList.remove('hidden');
  showLesson();
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø³ Ø£Ùˆ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
function showLesson() {
  updateProgress();
  clearTimer();
  document.getElementById('timer').innerHTML = '';

  if ((currentIndex + 1) % 3 === 0) {
    showQuiz();
  } else {
    const lesson = lessons[currentIndex];
    document.getElementById('lessonArea').innerHTML = `
      <div class="lesson">
        <img src="${lesson.image}" alt="ØµÙˆØ±Ø© ${lesson.word}">
        <h2>${currentIndex + 1} Ù…Ù† ${lessons.length}</h2>
        <h1>${lesson.word}</h1>
        <p>${lesson.meaning}</p>
      </div>
    `;
    document.getElementById('nextButton').style.display = 'inline-block';
    isQuiz = false;
  }
}

// Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
function next() {
  if (!isQuiz) {
    currentIndex++;
    if (currentIndex >= lessons.length) {
      showCertificate();
    } else {
      localStorage.setItem('currentLesson', currentIndex);
      showLesson();
    }
  }
}

// Ø¹Ø±Ø¶ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø·Ù‚
function showQuiz() {
  const lesson = lessons[currentIndex];
  document.getElementById('lessonArea').innerHTML = `
    <div class="lesson">
      <h2>Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø·Ù‚</h2>
      <h1>${lesson.word}</h1>
      <button onclick="startRecognition('${lesson.word}')">ğŸ¤ Ø§Ø¶ØºØ· ÙˆØªÙƒÙ„Ù…</button>
    </div>
  `;
  document.getElementById('nextButton').style.display = 'none';
  isQuiz = true;

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø±Ø³ 25
  if (currentIndex >= 24) {
    startTimer(30); // 30 Ø«Ø§Ù†ÙŠØ©
  }
}
// ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª
function startRecognition(correctWord) {
  if (!('webkitSpeechRecognition' in window)) {
    alert('Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª!');
    return;
  }

  const recognition = new webkitSpeechRecognition();
  recognition.lang = 'en-US';
  recognition.start();

  recognition.onresult = function(event) {
    const result = event.results[0][0].transcript.trim().toLowerCase();
    if (result === correctWord.toLowerCase()) {
      document.getElementById('clapSound').play();
      clearTimer();
      alert('âœ… ØµØ­ÙŠØ­! Ø£Ø­Ø³Ù†Øª!');
      currentIndex++;
    } else {
      alert('âŒ Ø®Ø·Ø£! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      if (currentIndex > 0) currentIndex--;
    }

    if (currentIndex >= lessons.length) {
      showCertificate();
    } else {
      localStorage.setItem('currentLesson', currentIndex);
      showLesson();
    }
  };
}

// Ø¨Ø¯Ø¡ Ù…Ø¤Ù‚Øª Ø§Ù„Ù†Ø·Ù‚
function startTimer(seconds) {
  let timeLeft = seconds;
  document.getElementById('timer').innerText = `â° Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${timeLeft} Ø«Ø§Ù†ÙŠØ©`;

  timerInterval = setInterval(() => {
    timeLeft--;
    document.getElementById('timer').innerText = `â° Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${timeLeft} Ø«Ø§Ù†ÙŠØ©`;

    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      alert('â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      if (currentIndex > 0) currentIndex--;
      localStorage.setItem('currentLesson', currentIndex);
      showLesson();
    }
  }, 1000);
}

// Ø§ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª
function clearTimer() {
  if (timerInterval) {
    clearInterval(timerInterval);
    timerInterval = null;
  }
}

// ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
function updateProgress() {
  const progress = (currentIndex / lessons.length) * 100;
  document.getElementById('progress-bar').style.width = progress + "%";
  document.getElementById('progress-text').innerText = progress.toFixed(0) + "%";
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
function showCertificate() {
  localStorage.removeItem('currentLesson');
  document.getElementById('lessonPage').classList.add('hidden');
  document.getElementById('certificatePage').classList.remove('hidden');
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ÙƒØµÙˆØ±Ø©
function downloadCertificate() {
  html2canvas(document.getElementById('certificatePage')).then(function(canvas) {
    const link = document.createElement('a');
    link.download = 'Ø´Ù‡Ø§Ø¯Ø©_Ø§Ù„ØªØ®Ø±Ø¬.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}

// Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¯ÙˆØ±Ø©
function restart() {
  location.reload();
}
</script>

</body>
</html>
